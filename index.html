<!DOCTYPE html>
<!--
/*
This  program is free software;
you can redistribute it and/or modify it under the terms of the
GNU General Public License as published by the Free Software Foundation;
either version 3 of the License, or any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
*/
-->
<html>
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>wwwouaiebe - base64</title>
		<style>
		</style>
	</head>
	<body>
	<h1>Encoding et decoding to base64</h1>
		<h2>Text to base64 or base64 to text</h2>
		<h3>Text</h3>
		<p>
			<textarea cols="128" rows="6" name="Decode" id="Decode" placeholder="Text" spellcheck="false" ></textarea>
		</p>
		<p><button onclick="encode( true )" value="To base64" >To base64 and to clipboard</button><button onclick="encode( false )" value="To base64" >To base64 only</button></p>
		<h3>Base64</h3>
		<p>
			<textarea cols="128" rows="6" name="Encode" id="Encode" placeholder="base64" spellcheck="false" ></textarea>
		</p>
		<p><button onclick="decode( true )" value="To text" >To text and to clipboard</button><button onclick="decode( false )" value="To text" >To text only</button></p>
		<h2>Image to base64</h2>
		<p>Select an image:</p>
		<div><input type='file' accept="image/*" id="ImageInput" /></div>
		<p>
			<textarea cols="128" rows="10" name="ImageEncode" id="ImageEncode" placeholder="Image to base64" spellcheck="false" ></textarea>
		</p>
		<p><button onclick="copy()" value="Copy" >To clipboard</button></p>
		<p>
			<img id="Image" src="" />
		</p>
		<h2>Base64 to image</h2>
		<p>
			<textarea cols="128" rows="10" name="ImageDecode" id="ImageDecode" placeholder="Base64 to image" spellcheck="false" ></textarea>
		</p>
		<p><button onclick="decodeImage()" value="Copy" >To image</button><button onclick="saveImage()" value="Copy" >Save file...</button></p>
		<p>
			<img id="decodedImage" src="" />
		</p>
		<script>
			function decodeImage ( event ) {
				document.getElementById ( "decodedImage" ).src = document.getElementById ( "ImageDecode" ).value; 
			};
			function saveImage ( event ) {
				var element = document.createElement ( 'a' );
				element.setAttribute( 'href', document.getElementById ( "ImageDecode" ).value );
				element.setAttribute( 'download', 'img' );
				element.style.display = 'none';
				document.body.appendChild ( element );
				element.click ( );
				document.body.removeChild ( element );
			};
			
			function encodeImage ( event ) {
				var fileReader = new FileReader( );
				fileReader.onloadend  = function ( event ) {
					var textArea = document.getElementById("ImageEncode");
					textArea.value = fileReader.result;
					document.getElementById ( "Image" ).src = fileReader.result;
					textArea.focus ( );
					textArea.select ( );
					document.execCommand ( 'copy' );
				};
				fileReader.readAsDataURL ( event.target.files [ 0 ] );
			};
			document.getElementById ( "ImageInput" ).addEventListener ( 'change' , encodeImage);

			function copy ( ) {
				var textArea = document.getElementById("ImageEncode");
				textArea.focus ( );
				textArea.select ( );
				document.execCommand ( 'copy' );
			};
			
			function encode ( toClipboard ) {
				var Encode = btoa ( unescape(encodeURIComponent( document.getElementById ( "Decode" ).value ) ) );
				var textArea = document.getElementById("Encode");
				textArea.value = Encode;
				textArea.focus ( );
				textArea.select ( toClipboard );
				if ( toClipboard ) { document.execCommand ( 'copy' ) };
			};

			function decode ( toClipboard ) {
				var Decode = decodeURIComponent ( escape( atob ( document.getElementById ( "Encode" ).value ) ) );
				var textArea = document.getElementById ( "Decode" );
				textArea.value = Decode;
				textArea.focus ( );
				textArea.select ( );
				if ( toClipboard ) { document.execCommand ( 'copy' ) };
			};
		</script>
	</body>
</html>